<!-- mantenimientos/templates/mantenimientos/mantenimiento_detail.html -->
{% extends "base.html" %}
{% load static %}

{% block content_authenticated %}
<h2>Detalle de mantenimiento</h2>

<div class="card mb-3">
  <div class="card-body">
    <p><strong>Fecha:</strong> {{ mantenimiento.fecha }}</p>
    <p><strong>Cantidad:</strong> {{ mantenimiento.cantidad }}</p>
  </div>
</div>

<a href="{% url 'mantenimiento_update' mantenimiento.pk %}" class="btn btn-outline-primary">Editar</a>
<a href="{% url 'mantenimiento_delete' mantenimiento.pk %}" class="btn btn-outline-danger">Eliminar</a>

<div class="mt-4">
  <h5>Evolución últimos 7 días</h5>
  <canvas id="graficoSemana"></canvas>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('graficoSemana');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: {{ dias_json|safe }},
      datasets: [{
        label: 'Mantenimientos',
        data: {{ cantidades_json|safe }},
        borderColor: 'rgba(75, 192, 192, 1)',
        backgroundColor: 'rgba(75, 192, 192, 0.2)',
        fill: true,
        tension: 0.3
      }]
    },
    options: {
      scales: { y: { beginAtZero: true, max: 15 } }
    }
  });
</script>
{% endblock %}
